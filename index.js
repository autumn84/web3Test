var Web3 = require("web3");

// 连接到以太坊节点
const provider = new Web3.providers.HttpProvider("http://**:8545");
// 创建web3对象
const web3 = new Web3('');
web3.setProvider(provider);

console.log(web3);

(async() => {
const blockAfter = await web3.eth.getBlockNumber();
console.log(blockAfter);

// 合约ABI
var abi = [{"constant":true,"inputs":[],"name":"BURNRATE_TIER2","outputs":[{"name":"","type":"uint16"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"BURNRATE_TIER1","outputs":[{"name":"","type":"uint16"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"downtimePriceLRCPerDay","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_blockVerifierAddress","type":"address"},{"name":"_exchangeCreationCostLRC","type":"uint256"},{"name":"_tierUpgradeCostBips","type":"uint16"},{"name":"_maxWithdrawalFee","type":"uint256"},{"name":"_downtimePriceLRCPerDay","type":"uint256"},{"name":"_withdrawalFineLRC","type":"uint256"},{"name":"_tokenRegistrationFeeLRCBase","type":"uint256"},{"name":"_tokenRegistrationFeeLRCDalta","type":"uint256"}],"name":"updateSettings","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"withdrawalFineLRC","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"exchanges","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"exchangeId","type":"uint256"}],"name":"burnAllStake","outputs":[{"name":"burnedLRC","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"lrcAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"tokenRegistrationFeeLRCDelta","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"wethAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"TIER_UPGRADE_DURATION","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"BURNRATE_TIER3","outputs":[{"name":"","type":"uint16"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"BURNRATE_TIER4","outputs":[{"name":"","type":"uint16"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"token","type":"address"}],"name":"getLRCCostToBuydownTokenBurnRate","outputs":[{"name":"amountLRC","type":"uint256"},{"name":"currentTier","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"exchangeCreationCostLRC","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"exchangeId","type":"uint256"},{"name":"amountLRC","type":"uint256"}],"name":"depositStake","outputs":[{"name":"stakedLRC","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"totalStake","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"blockVerifierAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"tokenRegistrationFeeLRCBase","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"exchangeDeployerAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"exchangeId","type":"uint256"},{"name":"recipient","type":"address"},{"name":"requestedAmount","type":"uint256"}],"name":"withdrawStake","outputs":[{"name":"amount","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"exchangeId","type":"uint256"},{"name":"amount","type":"uint256"}],"name":"burnStake","outputs":[{"name":"burnedLRC","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"tierUpgradeCostBips","outputs":[{"name":"","type":"uint16"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"exchangeId","type":"uint256"}],"name":"getStake","outputs":[{"name":"stakedLRC","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"operator","type":"address"},{"name":"onchainDataAvailability","type":"bool"}],"name":"createExchange","outputs":[{"name":"exchangeId","type":"uint256"},{"name":"exchangeAddress","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"token","type":"address"},{"name":"recipient","type":"address"}],"name":"withdrawTheBurn","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"token","type":"address"}],"name":"getTokenBurnRate","outputs":[{"name":"burnRate","type":"uint16"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"tokens","outputs":[{"name":"tokenAddress","type":"address"},{"name":"tier","type":"uint8"},{"name":"tierValidUntil","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"token","type":"address"}],"name":"buydownTokenBurnRate","outputs":[{"name":"amountBurned","type":"uint256"},{"name":"currentTier","type":"uint8"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"maxWithdrawalFee","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":true,"name":"exchangeId","type":"uint256"},{"indexed":true,"name":"exchangeAddress","type":"address"},{"indexed":true,"name":"owner","type":"address"},{"indexed":false,"name":"operator","type":"address"},{"indexed":false,"name":"burnedLRC","type":"uint256"}],"name":"ExchangeCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"exchangeId","type":"uint256"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"StakeDeposited","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"exchangeId","type":"uint256"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"StakeBurned","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"exchangeId","type":"uint256"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"StakeWithdrawn","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"time","type":"uint256"}],"name":"SettingsUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"token","type":"address"},{"indexed":true,"name":"tier","type":"uint256"},{"indexed":false,"name":"time","type":"uint256"}],"name":"TokenBurnRateDown","type":"event"}];

// 合约地址
var address = "0x0faf647ac905fF0Bc8d0eF88c8f5De968CFC3F43";

web3.eth.getAccounts()
.then(console.log);

// 通过ABI和地址获取已部署的合约对象
var loopringV3 = web3.eth.Contract(abi, address);

var stake = await loopringV3.methods.getStake(0).call();
console.log("stake: ", stake);

var downtimePriceLRCPerDay = await loopringV3.methods.downtimePriceLRCPerDay().call();
console.log("downtimePriceLRCPerDay: ", downtimePriceLRCPerDay);

var lrcAddress = await loopringV3.methods.lrcAddress().call();
console.log("lrcAddress: ", lrcAddress);

var burnRate = await loopringV3.methods.getTokenBurnRate("0x926861324599A614091BB2Cd3b3852cB1C2f465d").call();
console.log("burnRate: ", burnRate);


})();
